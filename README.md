# 중환자실 임상 데이터를 활용한 근거 기반 사망 위험 조기 예측 분석
ICU 패혈증 환자 임상 변수의 해석 중심 예후 예측 및 모델 비교

---

# 프로젝트 개요

본 프로젝트는 ICU 패혈증 환자의 전자의무기록(EMR) 기반 임상 데이터를 활용하여
입실 초기 임상 변수로 사망 위험을 조기 예측하고,
예측 결과를 임상적으로 해석 가능한 형태로 제공하는 것을 목표로 한다.

단순한 모델 성능 비교를 넘어 임상적으로 의미 있는 변수 선택 근거
의료 의사결정에 활용 가능한 성능 지표
모델 간 성능 차이에 대한 통계적 검증을 중심으로 분석을 설계하였다.

---

# 프로젝트 배경

중환자실(ICU) 패혈증 환자의 사망 위험은
입실 초기 임상 지표를 통해 어느 정도 예측이 가능하지만,
모델 성능뿐 아니라 의료진이 신뢰하고 해석할 수 있는 근거 제시가 중요하다.

ICU 예후 예측 모델은 높은 정확도뿐 아니라 설명 가능성이 필수
기존 연구는 AUC 중심 성능 비교에 치우친 경우가 많음
실제 임상에서는 민감도, 음성예측도(NPV), 임상 해석 가능성이 중요

즉, 가장 성능이 좋은 모델이 아니라
임상 적용 가능성이 높은 모델과 변수 구조를 도출하는 것이 핵심

---

# 변수 설계 및 특징 선택

선행 임상 연구를 기반으로 주요 예후 관련 변수 검토
젖산(lactate), 활력징후, 장기 기능 관련 지표 등
SHAP 중요도를 활용하여 예측 기여도가 높은 변수 파악
VIF 기반 다중공선성 검토 후 중복·파생 변수 정제

변수 선택 과정에서 임상적 근거와 통계적 타당성을 함께 고려

---

# 폴더 구조

```
ICU_Sepsis_EarlyPred/
├─ data/
│  └─ ICU_Clinical_split_data.zip         # 분할된 입력 데이터(학습/검증/시험)
├─ model-optuna/                           # 모델별 Optuna 탐색 스크립트
│  ├─ FTT_optuna.py                        # FT-Transformer
│  ├─ LGBM_optuna.py                       # LightGBM
│  ├─ RF_optuna.py                         # Random Forest
│  ├─ SVM_optuna.py                        # SVM
│  ├─ TabNet_optuna.py                     # TabNet
│  ├─ XGBoost_optuna.py                    # XGBoost
│  └─ resnet_optuna.py                     # (이미지형 미사용 시 보조 실험)
├─ tuning/                                 # 최종 튜닝 적용 스크립트(재현용)
│  ├─ Catboost_last.py
│  ├─ FTT_tuning.py
│  ├─ LGBM_tuning.py
│  ├─ RF_tuning.py
│  ├─ SVM_last.py
│  ├─ TabNet_tuning.py
│  ├─ TabPFN_tuning.py
│  └─ XGBoost_tuning.py
└─ README.md
```

---

# 주요 결과

단순 AUC 기준에서는 일부 모델 간 유의미한 차이가 크지 않음

CatBoost 모델이 민감도 및 균형정확도에서 전반적으로 우수
임상적으로 중요한 고위험 환자 탐지에 유리

모델 간 상보성은 제한적이었으며,
단일 모델 기반의 안정적 예측이 현실적인 선택으로 판단

---

# 결론 및 의의

ICU 예후 예측에서는 최고 성능보다 임상 해석 가능성과 위험 환자 조기 탐지가 중요
변수 선택 단계에서의 임상 근거 제시가 모델 신뢰도에 직접적 영향
본 분석은 의료진 의사결정을 지원하는 설명 가능한 예후 예측 사례로 활용 가능
